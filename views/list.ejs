<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="main.css" rel="stylesheet">
</head>

<%- include('nav.ejs') %>


<body class="grey-bg">
    <div class="white-bg">
      <% for (let i = 0; i < posts.length; i++){ %>
      <div class="list-box">
        <h4>
          <a href="/detail/<%= posts[i]._id %>">
            <%= posts[i].title %>
        </a>
        <a href = "/edit/<%= posts[i]._id %>">âœï¸</a>
        <span class="delete" data-id="<%= posts[i]._id %>">ğŸ—‘ï¸</span>
       </h4>
        <p><%= posts[i].content %></p> 
      </div>
  <%  }  %> 
    </div>
<!---->

    <!--ë‹¤ìŒì€ AJAX ì‚¬ìš©ë²•-->
<!--ê¸°ë³¸ì ì¸ ìë°” ìŠ¤í¬ë¦½íŠ¸ ë¬¸ë²•-->
<!--1.ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•˜ê³  ë‚œ ë’¤ ì— ë‹¤ìŒê³¼ ê°™ì€ êµ¬ì ˆ ì…ë ¥-->
<!--querySelectorAll : ì›í•˜ëŠ” HTMLìš”ì†Œë¥¼ ì°¾ìŒ-->
<!--addEventListener : í´ë¦­ì‹œ ë‹¤ìŒê³¼ ê°™ì€ ì½”ë“œ ì‹¤í–‰-->    
   <script>
    // "deleteë¼ëŠ” í´ë˜ìŠ¤ëª…ì„ ê°€ì§„ ì—¬ëŸ¬ html ìš”ì†Œ ì¤‘ 0ë²ˆì§¸ë¥¼ ì°¾ì•„ì„œ í´ë¦­ì‹œ fetch() ì‹¤í–‰í•´ë¼ë¼ëŠ” ëœ»
    document.querySelectorAll('.delete')[0].addEventListener('click',function(e){
    //fetch GET,POST,PUT,DELETE    
    // 1.GET: fetch ê´„í˜¸ì•ˆì— urlì„ ì ìœ¼ë©´ í•´ë‹¹ URLë¡œ GETìš”ì²­ì´ ë‚ ë¼ê° very easy
    // 2.POST: í•´ë‹¹ URLì„ ê´„í˜¸ì•ˆì— ì ê³  ì¤‘ê´„í˜¸ë¥¼ ì—´ê³  ê°’ì„ ë„£ìœ¼ë©´ ë¨ ì•„ë˜ ì˜ˆì‹œ
    fetch('/delete?docid='+ e.target.dataset.id, {
      method : 'DELETE',
      })
    })
    //ì„œë²„ë¡œ ë°ì´í„° ë³´ë‚´ëŠ” ë‹¤ë¥¸ ë°©ë²• 2ê°€ì§€
    // 1. querystring
    // 2. URLparameter
  
   </script>
  </body>
</html>